<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Encrypting Multiple PDF Files with Python</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Python and Power BI with Asad </a></h1>
                <nav><ul>
                    <li><a href="/pages/about-me.html">about me</a></li>
                    <li class="active"><a href="/category/blog.html">Blog</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/encrypting-multiple-pdf-files-with-python.html" rel="bookmark"
           title="Permalink to Encrypting Multiple PDF Files with Python">Encrypting Multiple PDF Files with Python</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2019-07-07T10:20:00+05:00">
                Published: Sun 07 July 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/asad.html">Asad</a>
        </address>
<p>In <a href="/category/blog.html">Blog</a>.</p>

</footer><!-- /.post-info -->      <h4>An extremely short introduction to Python</h4>
<p>Python is a programming language that has a lot of applications in various industries like Software Development, Data Science, Robotics and Web Development. In this article we will see a side of python that a typical office person can use in order to get things done in a more organized way and doing so, save a lot of time.</p>
<h4>Background</h4>
<p>I was recently working on a project that required me to share a lot of files with 3 groups of people on a single team drive (now called shared drive) in Google Drive. We needed three different folders and 3 different passwords for each folder that was shared in the drive. Each folder had multiple subfolders and each subfolder a lot of files. Doing this manually would take a lot of time and concentration, and there would be a high chance of making a mistake or missing a file. The widely used application for such a task is the Acrobat Reader from Adobe. However, you require a paid version of Adobe to encrypt files. As most of the boring tasks, this required some Python automation. I wrote a script that would automate this task. Here are the steps required to achieve the required results.</p>
<ol>
<li>Install Python on your computer.<ol>
<li>This can be done by visiting <a>python.org/downloads</a> <em>(Grab the latest stable version)</em></li>
</ol>
</li>
<li>Create a text file <em>(On windows right click anywhere and hover New and select text document)</em></li>
<li>Open the file in a text editor of your choice like notepad or sublime text</li>
<li>Copy and paste the code in this notebook into the text file and save the file with a .py extension</li>
<li>Run the file via the command prompt <em>(The command prompt can be opened via start menu by searching for cmd or you can google for a lot of other ways to open the command prompt)</em></li>
</ol>
<p><strong>Although the code should work on any operating system, however, I can only guarantee that it will work on windows. Give it a try and get back to me if you run into any trouble.</strong></p>
<p><em>without further ado, let us write some python</em></p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span> <span class="c1"># a library to manage copying and pasting</span>
<span class="kn">import</span> <span class="nn">pikepdf</span> <span class="c1"># A well written library to work with python</span>
<span class="kn">from</span> <span class="nn">pikepdf</span> <span class="kn">import</span> <span class="n">Pdf</span>
</pre></div>


<p><strong>Change some password with a password of your choice but don't remove the quotes</strong></p>
<div class="highlight"><pre><span></span><span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;some password&#39;</span>
</pre></div>


<p><strong>path is the location of the folder in which your pdf files are located that you want to encrypt. change it accordingly</strong></p>
<div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;C:/Users/username/desktop/pdf_folder&#39;</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">protect</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function takes a file as an input and creates another file in the same destination</span>
<span class="sd">    This file is encrypted with the password defined earlier</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">Pdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>    
    <span class="n">pdf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="nb">file</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_encrypted.pdf&#39;</span><span class="p">,</span> 
             <span class="n">encryption</span><span class="o">=</span><span class="n">pikepdf</span><span class="o">.</span><span class="n">Encryption</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span> 
    <span class="c1"># you can change the 4 to 6 for 256 aes encryption but that file won&#39;t open on Acrobat versions lower than 10.0</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">remove_originals</span><span class="p">(</span><span class="nb">file</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This will remove the files that don&#39;t end with _encrypted.pdf in their names</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_encrypted.pdf&#39;</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#protecting</span>
<span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>
            <span class="n">protect</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="nb">file</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#removing originals</span>
<span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>    
            <span class="n">remove_originals</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="nb">file</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#renaming the encrypted files to match the original filenames</span>
<span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="nb">file</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="nb">file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_encrypted&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)))</span>
</pre></div>


<p><em>once you run the file, this will encrypt all your pdfs, as a precaution, create a copy of your folder before you run this script. In order to run the file from command prompt, open command prompt and type python filename.py and press enter. Alternatively, you can just copy the code from the code block below:</em></p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span> <span class="c1"># a library to manage copying and pasting</span>
<span class="kn">import</span> <span class="nn">pikepdf</span> <span class="c1"># A well written library to work with python</span>
<span class="kn">from</span> <span class="nn">pikepdf</span> <span class="kn">import</span> <span class="n">Pdf</span>

<span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;some password&#39;</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;C:/Users/username/desktop/pdf_folder&#39;</span>

<span class="k">def</span> <span class="nf">protect</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function takes a file as an input and creates another file in the same destination</span>
<span class="sd">    This file is encrypted with the password defined earlier</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">Pdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>    
    <span class="n">pdf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="nb">file</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_encrypted.pdf&#39;</span><span class="p">,</span> 
             <span class="n">encryption</span><span class="o">=</span><span class="n">pikepdf</span><span class="o">.</span><span class="n">Encryption</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span> 
    <span class="c1"># you can change the 4 to 6 for 256 aes encryption but that file won&#39;t open on Acrobat versions lower than 10.0</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span>

<span class="k">def</span> <span class="nf">remove_originals</span><span class="p">(</span><span class="nb">file</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This will remove the files that don&#39;t end with _encrypted.pdf in their names</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_encrypted.pdf&#39;</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>

<span class="c1">#protecting</span>
<span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>
            <span class="n">protect</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="nb">file</span><span class="p">))</span>

<span class="c1">#removing originals</span>
<span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>    
            <span class="n">remove_originals</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="nb">file</span><span class="p">))</span>

<span class="c1">#renaming the encrypted files to match the original filenames</span>
<span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="nb">file</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="nb">file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_encrypted&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)))</span>
</pre></div>


<h3>Some youtube channels for learning python:</h3>
<ol>
<li><a href="https://www.youtube.com/user/sentdex">Sentdex</a></li>
<li><a href="https://www.youtube.com/user/schafer5">Corey Schafer</a></li>
<li><a href="https://www.youtube.com/channel/UC4JX40jDee_tINbkjycV4Sg">Tech With Tim</a></li>
</ol>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>