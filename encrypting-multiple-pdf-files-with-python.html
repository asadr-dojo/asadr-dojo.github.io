
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://rauf-asad.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://rauf-asad.github.io/theme/pygments/monokai.min.css">
  <link rel="stylesheet" type="text/css" href="https://rauf-asad.github.io/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://rauf-asad.github.io/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://rauf-asad.github.io/theme/font-awesome/css/solid.css">




    <link rel="shortcut icon" href="https://rauf-asad.github.io/images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="https://rauf-asad.github.io/images/favicon.ico" type="image/x-icon">


    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#3aa500">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#3aa500">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#3aa500">

<meta name="author" content="Asad Rauf" />
<meta name="description" content="This article shows how you can use python to automate encrypting PDF files." />
<meta name="keywords" content="Automation, Batch Encrypt Files, Python Automation">

<meta property="og:site_name" content="Asad Rauf"/>
<meta property="og:title" content="Encrypting Multiple PDF Files with Python"/>
<meta property="og:description" content="This article shows how you can use python to automate encrypting PDF files."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://rauf-asad.github.io/encrypting-multiple-pdf-files-with-python.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2019-07-07 10:20:00+05:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://rauf-asad.github.io/author/asad-rauf.html">
<meta property="article:section" content="Blog"/>
<meta property="article:tag" content="Automation"/>
<meta property="article:tag" content="Batch Encrypt Files"/>
<meta property="article:tag" content="Python Automation"/>
<meta property="og:image" content="https://rauf-asad.github.io/images/profile.png">

  <title>Asad Rauf &ndash; Encrypting Multiple PDF Files with Python</title>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-4215435594103364",
      enable_page_level_ads: true
    });
  </script>
</head>
<body>
  <aside>
    <div>
      <a href="https://rauf-asad.github.io">
        <img src="https://rauf-asad.github.io/images/profile.png" alt="" title="">
      </a>
      <h1><a href="https://rauf-asad.github.io"></a></h1>

<p>Data Scientist</p>
      <nav>
        <ul class="list">
          <li><a href="https://rauf-asad.github.io/pages/about-me.html#about-me">about&nbsp;me</a></li>

          <li><a href="/" target="_blank">Blog</a></li>
        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-github" href="https://www.github.com/rauf-asad" target="_blank">
            <i class="fab fa-github">
            </i>
          </a></li>
          <li>
            <a  class="sc-linkedin" href="https://www.linkedin.com/in/asad-rauf-46a50061/" target="_blank">
            <i class="fab fa-linkedin">
            </i>
          </a></li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/asad__rauf" target="_blank">
            <i class="fab fa-twitter">
            </i>
          </a></li>
          <li>
            <a  class="sc-stack-overflow" href="https://stackoverflow.com/users/6773458/asad-rauf" target="_blank">
            <i class="fab fa-stack-overflow">
            </i>
          </a></li>
      </ul>
    </div>

      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      <ins class="adsbygoogle ads-aside"
           data-ad-client="ca-pub-4215435594103364"
           data-ad-slot="1234561"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>

  </aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="encrypting-multiple-pdf-files-with-python">Encrypting Multiple <span class="caps">PDF</span> Files with&nbsp;Python</h1>
    <p>
          Posted on Sun 07 July 2019 in <a href="https://rauf-asad.github.io/category/blog.html">Blog</a>


    </p>
  </header>


  <div>
    <h4>An extremely short introduction to&nbsp;Python</h4>
<p>Python is a programming language that has a lot of applications in various industries like Software Development, Data Science, Robotics and Web Development. In this article we will see a side of python that a typical office person can use in order to get things done in a more organized way and doing so, save a lot of&nbsp;time.</p>
<h4>Background</h4>
<p>I was recently working on a project that required me to share a lot of files with 3 groups of people on a single team drive (now called shared drive) in Google Drive. We needed three different folders and 3 different passwords for each folder that was shared in the drive. Each folder had multiple subfolders and each subfolder a lot of files. Doing this manually would take a lot of time and concentration, and there would be a high chance of making a mistake or missing a file. The widely used application for such a task is the Acrobat Reader from Adobe. However, you require a paid version of Adobe to encrypt files. As most of the boring tasks, this required some Python automation. I wrote a script that would automate this task. Here are the steps required to achieve the required&nbsp;results.</p>
<ol>
<li>
<p>Install Python on your&nbsp;computer.</p>
<ol>
<li>This can be done by visiting <a>python.org/downloads</a> <em>(Grab the latest stable&nbsp;version)</em></li>
</ol>
</li>
<li>
<p>Create a text file <em>(On windows right click anywhere and hover New and select text&nbsp;document)</em></p>
</li>
<li>
<p>Open the file in a text editor of your choice like notepad or sublime&nbsp;text</p>
</li>
<li>
<p>Copy and paste the code in this notebook into the text file and save the file with a .py&nbsp;extension</p>
</li>
<li>
<p>install the requirement library by opening command prompt and running the&nbsp;command</p>
<p><code>pip install pikepdf</code></p>
</li>
<li>
<p>Run the file via the command prompt <em>(The command prompt can be opened via start menu by searching for cmd or you can google for a lot of other ways to open the command&nbsp;prompt)</em></p>
</li>
</ol>
<p><strong>Although the code should work on any operating system, however, I can only guarantee that it will work on windows. Give it a try and get back to me if you run into any&nbsp;trouble.</strong></p>
<p><em>without further ado, let us write some&nbsp;python</em></p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span> <span class="c1"># a library to manage copying and pasting</span>
<span class="kn">import</span> <span class="nn">pikepdf</span> <span class="c1"># A well written library to work with python</span>
<span class="kn">from</span> <span class="nn">pikepdf</span> <span class="kn">import</span> <span class="n">Pdf</span>
</pre></div>


<p><strong>Change some password with a password of your choice but don&#8217;t remove the&nbsp;quotes</strong></p>
<div class="highlight"><pre><span></span><span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;some password&#39;</span>
</pre></div>


<p><strong>path is the location of the folder in which your pdf files are located that you want to encrypt. change it&nbsp;accordingly</strong></p>
<div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;C:/Users/username/desktop/pdf_folder&#39;</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">protect</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function takes a file as an input and creates another file in the same destination</span>
<span class="sd">    This file is encrypted with the password defined earlier</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">Pdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>    
    <span class="n">pdf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_encrypted.pdf&#39;</span><span class="p">,</span> 
             <span class="n">encryption</span><span class="o">=</span><span class="n">pikepdf</span><span class="o">.</span><span class="n">Encryption</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span> 
    <span class="c1"># you can change the 4 to 6 for 256 aes encryption but that file won&#39;t open on Acrobat versions lower than 10.0</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">remove_originals</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This will remove the files that don&#39;t end with _encrypted.pdf in their names</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_encrypted.pdf&#39;</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#protecting</span>
<span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>
            <span class="n">protect</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">file</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#removing originals</span>
<span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>    
            <span class="n">remove_originals</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">file</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#renaming the encrypted files to match the original filenames</span>
<span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">file</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_encrypted&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)))</span>
</pre></div>


<p><em>once you run the file, this will encrypt all your pdfs, as a precaution, create a copy of your folder before you run this script. In order to run the file from command prompt, open command prompt and type python filename.py and press enter. Alternatively, you can just copy the code from the code block&nbsp;below:</em></p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span> <span class="c1"># a library to manage copying and pasting</span>
<span class="kn">import</span> <span class="nn">pikepdf</span> <span class="c1"># A well written library to work with python</span>
<span class="kn">from</span> <span class="nn">pikepdf</span> <span class="kn">import</span> <span class="n">Pdf</span>

<span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;some password&#39;</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;C:/Users/username/desktop/pdf_folder&#39;</span>

<span class="k">def</span> <span class="nf">protect</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This function takes a file as an input and creates another file in the same destination</span>
<span class="sd">    This file is encrypted with the password defined earlier</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">Pdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>    
    <span class="n">pdf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_encrypted.pdf&#39;</span><span class="p">,</span> 
             <span class="n">encryption</span><span class="o">=</span><span class="n">pikepdf</span><span class="o">.</span><span class="n">Encryption</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span> 
    <span class="c1"># you can change the 4 to 6 for 256 aes encryption but that file won&#39;t open on Acrobat versions lower than 10.0</span>
    <span class="n">pdf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span>

<span class="k">def</span> <span class="nf">remove_originals</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This will remove the files that don&#39;t end with _encrypted.pdf in their names</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_encrypted.pdf&#39;</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

<span class="c1">#protecting</span>
<span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>
            <span class="n">protect</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">file</span><span class="p">))</span>

<span class="c1">#removing originals</span>
<span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>    
            <span class="n">remove_originals</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">file</span><span class="p">))</span>

<span class="c1">#renaming the encrypted files to match the original filenames</span>
<span class="k">for</span> <span class="n">folder</span><span class="p">,</span> <span class="n">subfolders</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;.PDF&#39;</span><span class="p">)):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">file</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_encrypted&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)))</span>
</pre></div>


<h3>Some youtube channels for learning&nbsp;python:</h3>
<ol>
<li><a href="https://www.youtube.com/user/sentdex">Sentdex</a></li>
<li><a href="https://www.youtube.com/user/schafer5">Corey&nbsp;Schafer</a></li>
<li><a href="https://www.youtube.com/channel/UC4JX40jDee_tINbkjycV4Sg">Tech With&nbsp;Tim</a></li>
</ol>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://rauf-asad.github.io/tag/automation.html">Automation</a>
      <a href="https://rauf-asad.github.io/tag/batch-encrypt-files.html">Batch Encrypt Files</a>
      <a href="https://rauf-asad.github.io/tag/python-automation.html">Python Automation</a>
    </p>
  </div>





</article>

    <footer>
<p>&copy; Asad Rauf 2020</p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Asad Rauf ",
  "url" : "https://rauf-asad.github.io",
  "image": "https://rauf-asad.github.io/images/profile.png",
  "description": ""
}
</script>

</body>
</html>